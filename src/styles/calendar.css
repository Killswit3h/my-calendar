/* src/styles/calendar.css */
/* Scope everything under .calendar-root. No :root or global body rules. */
.calendar-root {
  /* Map global app tokens to local calendar variables */
  --primary: rgb(var(--accent));              /* accent color */
  --primary-contrast: rgb(var(--accent-fg));  /* on-accent text */
  --text: rgb(var(--fg));
  --text-dim: color-mix(in srgb, rgb(var(--fg)) 65%, transparent);
  --muted: rgb(var(--muted));
  --card: rgb(var(--card));
  --card-2: color-mix(in srgb, rgb(var(--card)) 88%, transparent);
  --elev-1: color-mix(in srgb, rgb(var(--card)) 84%, transparent);
  --elev-2: color-mix(in srgb, rgb(var(--card)) 78%, transparent);
  --border: color-mix(in srgb, var(--primary) 25%, transparent);
  --ring-outline: 0 0 0 3px color-mix(in srgb, var(--primary) 30%, transparent);

  --accent-500: var(--primary);

  /* Job type colors */
  --evt-guardrail:  #16a34a;
  --evt-fence:      #f97316;
  --evt-attenuator: #ef4444;
  --evt-temp-fence: #eab308;
  --evt-handrail:   #3b82f6;

  /* Blur radii */
  --glass-blur-8: 8px;
  --glass-blur-12: 12px;
  --glass-blur-16: 16px;
}

/* Container shell */
.calendar-root .cal-shell { max-width: 1200px; margin-inline: auto; padding-inline: 0.5rem; }
.calendar-root .surface {
  background: var(--card);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  backdrop-filter: blur(var(--glass-blur-12));
  -webkit-backdrop-filter: blur(var(--glass-blur-12));
  box-shadow: 0 2px 8px rgba(0,0,0,.3);
}
.calendar-root .muted-sm { color: var(--muted); font-size: 0.875rem; }
.calendar-root .country-input { width: 4.5rem; padding: 0.25rem 0.5rem; border-radius: 0.375rem; border: 1px solid var(--border); background: var(--elev-1); color: var(--text); }

/* ===== FullCalendar ===== */
.calendar-root .fc { font-size: clamp(12px, 1.1vw, 14px); color: var(--text); }
.calendar-root .fc .fc-toolbar { display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center; }
.calendar-root .fc .fc-toolbar-title { font-size: clamp(16px, 1.6vw, 20px); color: var(--text); font-weight: 700; }
.calendar-root .fc .fc-button { padding: 0.3rem 0.55rem; line-height: 1; background: var(--elev-2); border: 1px solid var(--border); color: var(--text); }
.calendar-root .fc .fc-button-primary { background: var(--primary) !important; border-color: var(--primary) !important; color: var(--primary-contrast) !important; }
.calendar-root .fc .fc-button-group .fc-button { border-radius: 0; }
.calendar-root .fc .fc-button-group .fc-button:first-child { border-top-left-radius: 10px; border-bottom-left-radius: 10px; }
.calendar-root .fc .fc-button-group .fc-button:last-child { border-top-right-radius: 10px; border-bottom-right-radius: 10px; }
.calendar-root .fc .fc-button-group .fc-button + .fc-button { margin-left: -1px; }
.calendar-root .fc .fc-button:hover { filter: brightness(1.1); }
.calendar-root .fc .fc-button-primary:not(:disabled).fc-button-active,
.calendar-root .fc .fc-button-primary:not(:disabled):active { background: var(--primary); border-color: var(--primary); color: var(--primary-contrast); }
.calendar-root .fc-theme-standard .fc-scrollgrid,
.calendar-root .fc-theme-standard td,
.calendar-root .fc-theme-standard th { border-color: var(--border); }
.calendar-root .fc .fc-daygrid-day-top { display: flex; align-items: center; justify-content: space-between; gap: 4px; padding: 2px 4px; }
.calendar-root .fc .fc-daygrid-day-number { color: var(--text-dim); font-size: clamp(11px, 1vw, 13px); position: relative; z-index: 1; }
.calendar-root .fc .fc-daygrid-day.fc-day-other .fc-daygrid-day-number { opacity: .55; }
.calendar-root .fc .fc-daygrid-day.fc-day-today { background: transparent; }
.calendar-root .fc .fc-daygrid-day.fc-day-today .fc-daygrid-day-frame,
.calendar-root .fc .fc-daygrid-day.fc-day-today .fc-daygrid-day-top { background: transparent !important; }
.calendar-root .fc .fc-daygrid-day.fc-day-today .fc-daygrid-day-number {
  color: var(--accent-500);
  background: transparent;
  border-radius: 999px;
  padding: 0;
  font-weight: 700;
  box-shadow: none;
}
.calendar-root .fc-daygrid-day-frame,
.calendar-root .fc-daygrid-day-events { min-height: 3.25rem; }
.calendar-root .fc-daygrid-day-events { padding-bottom: 26px; } /* space for + button */
.calendar-root .fc-more-link { font-size: 0.75rem; color: var(--text); }
.calendar-root .holiday-bg { background: color-mix(in srgb, var(--primary) 12%, transparent); }

/* Positioning for + button */
.calendar-root .fc-daygrid-day-frame { position: relative; }
.calendar-root .day-add-btn {
  position: absolute;
  right: 4px;
  bottom: 4px;
  width: 22px;
  height: 22px;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--card);
  color: var(--text);
  font-size: 14px;
  opacity: 0.9;
  z-index: 3;
  box-shadow: 0 1px 3px rgba(0,0,0,.35);
}
.calendar-root .day-add-btn:hover { filter: brightness(1.1); }
.calendar-root .day-add-btn:focus { outline: none; box-shadow: var(--ring-outline); }

/* Drag-and-drop highlights */
.calendar-root .drop-target-day {
  outline: 2px solid color-mix(in srgb, var(--accent-500) 65%, transparent);
  outline-offset: -4px;
  border-radius: 12px;
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--accent-500) 30%, transparent);
}
.calendar-root .drop-target-event { box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent-500) 55%, transparent); }

/* Calendar event chip pattern */
.calendar-root .fc .cal-event-chip {
  --chip-accent: var(--accent-500);
  background: transparent;
  border: none;
  color: inherit;
  text-decoration: none;
  background-color: transparent !important;
  box-shadow: none !important;
}
.calendar-root .fc .cal-event-chip .fc-event-main-frame,
.calendar-root .fc .cal-event-chip .fc-event-main {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
  padding: 0 !important;
}
.calendar-root .fc .cal-event-chip .fc-event-main { overflow: visible; padding: 0; }

.calendar-root .cal-event-chip.evt-guardrail { --chip-accent: var(--evt-guardrail); }
.calendar-root .cal-event-chip.evt-fence { --chip-accent: var(--evt-fence); }
.calendar-root .cal-event-chip.evt-attenuator { --chip-accent: var(--evt-attenuator); }
.calendar-root .cal-event-chip.evt-temp-fence { --chip-accent: var(--evt-temp-fence); }
.calendar-root .cal-event-chip.evt-handrail { --chip-accent: var(--evt-handrail); }

.calendar-root .cal-chip {
  display: flex;
  align-items: center;
  gap: 0.45rem;
  padding: 0.35rem 0.65rem;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--chip-accent, var(--accent-500)) 42%, transparent);
  background: color-mix(in srgb, rgba(10, 14, 24, 0.92) 70%, var(--chip-accent, var(--accent-500)) 22%);
  color: var(--text);
  font-size: 0.78rem;
  font-weight: 600;
  line-height: 1.2;
  min-width: 0;
  width: 100%;
  box-sizing: border-box;
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.08),
    0 6px 16px rgba(12, 18, 22, 0.32);
  backdrop-filter: blur(var(--glass-blur-8));
  -webkit-backdrop-filter: blur(var(--glass-blur-8));
  transition:
    transform var(--motion-duration-100, 140ms) var(--motion-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1)),
    box-shadow var(--motion-duration-100, 140ms) var(--motion-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));
}
.calendar-root .cal-chip mark {
  background: color-mix(in srgb, var(--chip-accent, var(--accent-500)) 35%, transparent);
  color: inherit;
  border-radius: 4px;
  padding: 0 2px;
}
.calendar-root .fc .cal-event-chip:hover .cal-chip {
  transform: translateY(-1px);
  box-shadow:
    inset 0 1px 0 rgba(255, 255, 255, 0.12),
    0 10px 24px rgba(12, 18, 22, 0.45);
}
.calendar-root .fc .cal-event-chip:focus-visible .cal-chip {
  outline: none;
  box-shadow:
    var(--ring-outline),
    inset 0 1px 0 rgba(255, 255, 255, 0.12),
    0 10px 24px rgba(12, 18, 22, 0.45);
}
.calendar-root .cal-chip__bullet {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: var(--chip-accent, var(--accent-500));
  box-shadow: 0 0 0 2px color-mix(in srgb, var(--chip-accent, var(--accent-500)) 32%, transparent);
  flex: 0 0 8px;
}
.calendar-root .cal-chip__title {
  flex: 1 1 auto;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.calendar-root .cal-chip__badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.15rem 0.45rem;
  border-radius: 999px;
  font-size: 0.6rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  background: color-mix(in srgb, var(--chip-accent, var(--accent-500)) 16%, rgba(255, 255, 255, 0.14));
  border: 1px solid color-mix(in srgb, var(--chip-accent, var(--accent-500)) 45%, transparent);
  color: var(--text);
  flex: 0 0 auto;
}
.calendar-root .cal-chip__link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--chip-accent, var(--accent-500)) 40%, transparent);
  background: color-mix(in srgb, var(--chip-accent, var(--accent-500)) 18%, transparent);
  color: inherit;
  text-decoration: none;
  flex: 0 0 auto;
  transition:
    background var(--motion-duration-100, 140ms) var(--motion-ease-in-out, cubic-bezier(0.4, 0, 0.2, 1)),
    border-color var(--motion-duration-100, 140ms) var(--motion-ease-in-out, cubic-bezier(0.4, 0, 0.2, 1)),
    transform var(--motion-duration-100, 140ms) var(--motion-ease-out, cubic-bezier(0.22, 0.61, 0.36, 1));
}
.calendar-root .cal-chip__link:hover {
  background: color-mix(in srgb, var(--chip-accent, var(--accent-500)) 26%, transparent);
  border-color: color-mix(in srgb, var(--chip-accent, var(--accent-500)) 55%, transparent);
  transform: translateY(-1px);
}
.calendar-root .cal-chip__pin {
  width: 12px;
  height: 12px;
  background: currentColor;
  mask: url("data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2024%2024%22%3E%3Cpath%20fill=%22currentColor%22%20d=%22M12%2022c5.5-5%209-8.9%209-13A9%209%200%201%200%203%209c0%204.1%203.5%208%209%2013Zm0-9.5a3.5%203.5%200%201%201%200-7%203.5%203.5%200%200%201%200%207Z%22/%3E%3C/svg%3E") no-repeat center / contain;
  -webkit-mask: url("data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2024%2024%22%3E%3Cpath%20fill=%22currentColor%22%20d=%22M12%2022c5.5-5%209-8.9%209-13A9%209%200%201%200%203%209c0%204.1%203.5%208%209%2013Zm0-9.5a3.5%203.5%200%201%201%200-7%203.5%203.5%200%200%201%200%207Z%22/%3E%3C/svg%3E") no-repeat center / contain;
}

/* ===== Modal: Add event ===== */
.calendar-root .modal-root { position: fixed; inset: 0; background: color-mix(in srgb, #000 45%, transparent); display: grid; place-items: center; padding: 1rem; backdrop-filter: blur(var(--glass-blur-16)); z-index: 100; }
.calendar-root .modal-card { width: min(720px, 96vw); max-height: 90vh; overflow: auto; background: var(--elev-1); color: var(--text); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 24px 60px rgba(0,0,0,.45); padding: 1rem 1.25rem; backdrop-filter: blur(var(--glass-blur-16)); -webkit-backdrop-filter: blur(var(--glass-blur-16)); }
.calendar-root .modal-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--text); }
.calendar-root .form-grid { display: grid; grid-template-columns: 1fr; gap: 0.75rem; align-items: start; }
.calendar-root .form-grid * { box-sizing: border-box; min-width: 0; }
.calendar-root .form-grid label { display: grid; gap: 0.25rem; }
.calendar-root .form-grid .label { font-size: 0.875rem; color: var(--text-dim); }
.calendar-root .form-grid input,
.calendar-root .form-grid select,
.calendar-root .form-grid textarea { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); }
.calendar-root .form-grid textarea { min-height: 100px; resize: vertical; }
.calendar-root .inline { display: inline-flex; align-items: center; gap: 0.5rem; }
@media (min-width: 640px) { .calendar-root .form-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } .calendar-root .span-2 { grid-column: 1 / -1; } }
.calendar-root .modal-actions { display: flex; gap: 0.5rem; justify-content: flex-end; }
.calendar-root .btn {
  height: 40px;
  padding: 0 24px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border-radius: 20px;
  border: none;
  background: var(--primary);
  color: var(--primary-contrast);
  font-size: 1rem;
  font-family: inherit;
  cursor: pointer;
  transition:
    box-shadow var(--motion-duration-100, 140ms) var(--motion-ease-in-out, cubic-bezier(0.4,0,0.2,1)),
    background var(--motion-duration-100, 140ms) var(--motion-ease-in-out, cubic-bezier(0.4,0,0.2,1));
}
.calendar-root .btn:hover { box-shadow: 0 2px 6px rgba(0,0,0,.3); }
.calendar-root .btn:focus-visible { outline: none; box-shadow: var(--ring-outline); }
.calendar-root .btn:active { box-shadow: none; }
.calendar-root .btn.primary { background: var(--primary); color: var(--primary-contrast); }
.calendar-root .btn.danger { background: #ff453a; color: #fff; }
.calendar-root .btn.ghost { background: transparent; color: var(--primary); }

.calendar-root .form-section { font-size: 0.9rem; font-weight: 500; color: var(--text); margin-top: 0.5rem; }
.calendar-root .label .ico { width: 1rem; height: 1rem; margin-right: 0.25rem; }
.calendar-root .type-chip { width: 12px; height: 12px; border-radius: 999px; display: inline-block; }
.calendar-root .shift-toggle { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); }
.calendar-root .shift-toggle.night { background: var(--elev-2); }
.calendar-root .form-grid input,
.calendar-root .form-grid select,
.calendar-root .form-grid textarea,
.calendar-root .shift-toggle { min-height: 44px; }

/* Day Weather (tiny, next to date) */
.calendar-root .fc .day-weather { margin-left: 2px; margin-right: 0; font-size: 0.72rem; color: var(--text-dim); text-decoration: none; display: inline-flex; gap: 4px; align-items: center; opacity: .95; }
.calendar-root .fc .day-weather:hover { text-decoration: underline; color: var(--text); }
.calendar-root .fc .day-weather .ico { font-size: 0.9em; line-height: 1; }

/* Full-bleed helpers */
.calendar-root .calendar-bleed,
.calendar-root .todo-bleed {
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;
  width: 100vw;
}

/* Full-width control row above calendar */
.calendar-root .cal-controls { display: flex; align-items: center; justify-content: flex-start; min-height: 56px; padding: 0 16px; gap: 10px; flex-wrap: wrap; margin-bottom: 1rem; }
.calendar-root .cal-controls input { border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); min-height: 44px; }
.calendar-root .search-input { width: 100%; max-width: 36rem; }
.calendar-root #quick-add-form { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; width: 100%; max-width: 36rem; }
.calendar-root .view-toggle .btn { min-height: 44px; }
.calendar-root .tablet-split { display: flex; gap: 1rem; }
.calendar-root .calendar-pane { flex: 1 1 75%; }
.calendar-root .details-pane { flex: 1 1 25%; overflow: auto; min-width: 240px; }
.calendar-root mark { background: var(--primary); color: var(--primary-contrast); }

/* Options dropdown */
.calendar-root .options-wrap { position: relative; display: inline-block; }
.calendar-root .cal-controls .options-wrap:first-of-type { position: absolute; left: 8px; top: 6px; z-index: 60; }
.calendar-root .menu-card { position: absolute; top: calc(100% + 6px); left: 0; min-width: 220px; background: var(--elev-1); border: 1px solid var(--border); border-radius: 12px; padding: 6px; z-index: 50; box-shadow: 0 8px 20px rgba(0,0,0,.35); backdrop-filter: blur(var(--glass-blur-12)); -webkit-backdrop-filter: blur(var(--glass-blur-12)); }
.calendar-root .menu-item,
.calendar-root .menu-card .btn,
.calendar-root .menu-row,
.calendar-root .menu-card a { display: flex; align-items: center; gap: 10px; width: 100%; text-align: left; background: transparent !important; color: var(--text) !important; border: 0 !important; padding: 10px 12px; border-radius: 10px; text-decoration: none; font-size: 0.95rem; line-height: 1.2; }
.calendar-root .menu-item:hover,
.calendar-root .menu-card .btn:hover,
.calendar-root .menu-row:hover,
.calendar-root .menu-card a:hover { background: var(--elev-2) !important; filter: none !important; }
.calendar-root .menu-ico { width: 18px; display: inline-block; text-align: center; opacity: .9; }
.calendar-root .menu-text { flex: 1 1 auto; }

/* Discrete icon button */
.calendar-root .icon-btn { min-width: 32px; min-height: 32px; width: 32px; height: 32px; border-radius: 999px; padding: 0; border: 1px solid var(--border); background: var(--elev-2); color: var(--text-dim); line-height: 1; display: inline-flex; align-items: center; justify-content: center; }
.calendar-root .icon-btn:hover { filter: brightness(1.1); color: var(--text); }

/* Hide legacy options block in second control row */
.calendar-root .cal-controls > div:nth-of-type(2) .options-wrap { display: none; }

/* Add icon for Employees link */
.calendar-root .menu-card a[href^="/employees"],
.calendar-root .menu-card .btn[href^="/employees"] { display: flex; align-items: center; gap: 10px; }
.calendar-root .menu-card a[href^="/employees"]::before,
.calendar-root .menu-card .btn[href^="/employees"]::before { content: 'ðŸ‘¥'; width: 18px; text-align: center; opacity: .9; }

/* Mobile drawer for Unassigned */
@media (max-width: 767px) {
  .calendar-root .details-pane { display: none; }
  .calendar-root .calendar-pane { flex: 1 1 100%; }
}
.calendar-root .fab-people {
  position: fixed;
  right: 12px;
  bottom: 12px;
  width: 44px; height: 44px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--primary);
  color: var(--primary-contrast);
  display: inline-flex; align-items: center; justify-content: center;
  box-shadow: 0 6px 16px rgba(0,0,0,.35);
  z-index: 70;
}
.calendar-root .fab-people:hover { filter: brightness(1.05); }
.calendar-root .fab-people .fab-badge { position: absolute; top: -4px; right: -4px; min-width: 18px; height: 18px; padding: 0 4px; border-radius: 999px; background: #ef4444; color: #fff; font-size: 11px; line-height: 18px; text-align: center; border: 1px solid rgba(0,0,0,.3); }

.calendar-root .drawer-root { position: fixed; inset: 0; background: color-mix(in srgb, #000 45%, transparent); z-index: 80; display: flex; justify-content: flex-end; }
.calendar-root .drawer-panel { width: min(92vw, 360px); height: 100%; background: var(--elev-1); border-left: 1px solid var(--border); padding: 12px; overflow: auto; backdrop-filter: blur(var(--glass-blur-12)); -webkit-backdrop-filter: blur(var(--glass-blur-12)); }
.calendar-root .drawer-header { display: flex; align-items: center; justify-content: space-between; font-weight: 600; margin-bottom: 8px; }

/* ===== TODO BOARD ===== */
.calendar-root .todo-section { margin-top: 1rem; }
.calendar-root .todo-title { font-size: 1.125rem; font-weight: 600; margin: 0.25rem 0 0.75rem; color: var(--text); text-align: center; }
.calendar-root .todo-grid {
  display: grid;
  gap: 0.5rem;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  align-items: start;
}
.calendar-root .qty-editor { margin-top: 1.25rem; padding: 1rem; border-radius: 12px; background: var(--card-2); border: 1px solid var(--border); }
.calendar-root .qty-header { display: flex; align-items: center; justify-content: space-between; gap: 1rem; margin-bottom: 0.75rem; flex-wrap: wrap; }
.calendar-root .qty-header h4 { margin: 0; font-size: 1rem; font-weight: 600; }
.calendar-root .qty-actions { display: inline-flex; gap: 0.5rem; flex-wrap: wrap; }
.calendar-root .qty-grid { display: grid; gap: 0.75rem; }
.calendar-root .qty-row { display: grid; gap: 0.75rem; grid-template-columns: minmax(0, 1fr); align-items: start; padding: 0.9rem; border: 1px solid var(--border); border-radius: 12px; background: var(--elev-1); }
.calendar-root .qty-cell label { display: grid; gap: 0.35rem; }
.calendar-root .qty-cell input,
.calendar-root .qty-cell textarea { width: 100%; padding: 0.55rem 0.7rem; border: 1px solid var(--border); border-radius: 10px; background: var(--card); color: var(--text); font-size: 0.95rem; }
.calendar-root .qty-inline { display: grid; gap: 0.75rem; grid-template-columns: minmax(110px, 140px) minmax(160px, 1fr); align-items: end; }
.calendar-root .qty-cell.qty-notes textarea { min-height: 96px; resize: vertical; }
.calendar-root .qty-actions-column { display: flex; justify-content: flex-end; align-items: center; gap: 0.5rem; }
.calendar-root .qty-cell.qty-quantity input { font-variant-numeric: tabular-nums; }
.calendar-root .qty-hint { margin-top: 0.75rem; color: var(--muted); font-size: 0.85rem; }
.calendar-root .qty-loading { color: var(--text-dim); font-size: 0.9rem; }
.calendar-root .qty-error { margin-bottom: 0.75rem; padding: 0.75rem 1rem; border-radius: 10px; background: rgba(255, 69, 58, 0.15); color: #ffd7d0; border: 1px solid rgba(255, 69, 58, 0.35); }
.calendar-root .qty-payitem-search { position: relative; display: grid; gap: 0.5rem; }
.calendar-root .qty-payitem-search input { padding-right: 3rem; }
.calendar-root .qty-payitem-search .btn { height: 36px; justify-content: center; }
.calendar-root .qty-payitem-search .btn.ghost { border: 1px solid var(--border); padding: 0 12px; border-radius: 999px; background: transparent; color: var(--text); }
.calendar-root .qty-payitem-search .btn.ghost:hover { background: rgba(255,255,255,0.05); }
.calendar-root .qty-suggestions { position: absolute; z-index: 90; top: calc(100% + 4px); left: 0; right: 0; background: var(--elev-2); border: 1px solid var(--border); border-radius: 10px; max-height: 220px; overflow: auto; padding: 4px; display: grid; gap: 4px; box-shadow: 0 16px 32px rgba(0,0,0,0.35); }
.calendar-root .qty-suggestions li { list-style: none; }
.calendar-root .qty-suggestions button { width: 100%; border: none; display: grid; grid-template-columns: minmax(0, 120px) 1fr auto; gap: 0.5rem; align-items: center; border-radius: 8px; padding: 0.5rem 0.6rem; background: transparent; color: var(--text); text-align: left; cursor: pointer; }
.calendar-root .qty-suggestions button:hover,
.calendar-root .qty-suggestions button:focus-visible { background: rgba(255,255,255,0.08); outline: none; }
.calendar-root .qty-suggestion-number { font-weight: 600; font-size: 0.9rem; }
.calendar-root .qty-suggestion-desc { font-size: 0.85rem; }
.calendar-root .qty-suggestion-unit { font-size: 0.75rem; text-align: right; color: var(--muted); }

@media (max-width: 900px) {
  .calendar-root .qty-inline { grid-template-columns: minmax(0, 1fr); }
}

/* Pay item manager */
.calendar-root .payitems-card { border: 1px solid var(--border); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; background: var(--card-2); }
.calendar-root .payitems-input { width: 100%; padding: 0.5rem 0.6rem; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--text); }
.calendar-root .payitems-textarea { width: 100%; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); padding: 0.75rem; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
.calendar-root .payitems-create-grid { display: grid; gap: 0.75rem; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); align-items: end; }
.calendar-root .payitems-actions { display: flex; justify-content: flex-end; }
.calendar-root .payitems-table-wrapper { overflow-x: auto; border-radius: 10px; border: 1px solid var(--border); background: var(--elev-1); }
.calendar-root .payitems-table { width: 100%; border-collapse: collapse; }
.calendar-root .payitems-table th,
.calendar-root .payitems-table td { text-align: left; padding: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.08); }
.calendar-root .payitems-table-actions { text-align: right; }
.calendar-root .payitems-import-actions { display: flex; gap: 0.75rem; margin-top: 0.75rem; }
.calendar-root .payitems-errors { margin: 0.5rem 0; color: #ffb4a9; font-size: 0.85rem; list-style: square; padding-left: 1.5rem; }
.calendar-root .payitems-card .btn { height: 36px; min-height: 36px; }
.calendar-root .payitems-condensed .payitems-card { padding: 0.75rem; }
.calendar-root .payitems-condensed .payitems-import-actions { flex-wrap: wrap; }

/* Modal tabs */
.calendar-root .modal-card--wide { width: min(860px, 96vw); max-height: 92vh; overflow: hidden; display: flex; flex-direction: column; }
.calendar-root .modal-content { display: flex; flex-direction: column; gap: 1.25rem; overflow-y: auto; padding-right: 0.25rem; flex: 1 1 auto; }
.calendar-root .tab-nav { display: flex; gap: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.12); padding-bottom: 0.5rem; flex-wrap: wrap; }
.calendar-root .tab-button { padding: 0.4rem 0.9rem; border-radius: 999px; border: 1px solid transparent; background: transparent; color: var(--text-dim); font-size: 0.9rem; cursor: pointer; transition: background 140ms cubic-bezier(0.4,0,0.2,1), color 140ms cubic-bezier(0.4,0,0.2,1), border-color 140ms cubic-bezier(0.4,0,0.2,1); }
.calendar-root .tab-button:hover { color: var(--text); }
.calendar-root .tab-button.active { background: color-mix(in srgb, var(--primary) 20%, transparent); color: var(--text); border-color: color-mix(in srgb, var(--primary) 40%, transparent); }
.calendar-root .tab-panels { display: block; }
.calendar-root .tab-panel { display: none; }
.calendar-root .tab-panel.active { display: block; }
.calendar-root .tab-stack { display: grid; gap: 1.25rem; }
.calendar-root .field { display: flex; flex-direction: column; gap: 0.35rem; }
.calendar-root .field-grid { display: grid; gap: 1rem; align-items: start; }
.calendar-root .field-grid.two { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
.calendar-root .field-grid.three { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
.calendar-root .field.span-2 { grid-column: 1 / -1; }
.calendar-root .field input,
.calendar-root .field textarea,
.calendar-root .field select { width: 100%; border-radius: 10px; border: 1px solid var(--border); padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); min-height: 44px; }
.calendar-root .field textarea { min-height: 110px; resize: vertical; }
.calendar-root .inline-select { display: flex; align-items: center; gap: 0.5rem; }
.calendar-root .inline-select select { flex: 1; padding: 0.5rem 0.65rem; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); min-height: 44px; }
.calendar-root .toggle-button { width: 100%; min-height: 44px; border-radius: 10px; border: 1px solid var(--border); background: var(--card-2); color: var(--text); padding: 0.55rem 0.75rem; cursor: pointer; transition: background 140ms cubic-bezier(0.4,0,0.2,1), border-color 140ms cubic-bezier(0.4,0,0.2,1); }
.calendar-root .toggle-button:hover { border-color: color-mix(in srgb, var(--primary) 60%, transparent); }
.calendar-root .toggle-button.active { background: var(--primary); border-color: var(--primary); color: var(--primary-contrast); }
.calendar-root .field .label { font-size: 0.85rem; color: var(--text-dim); font-weight: 500; }
.calendar-root .field-hint { font-size: 0.8rem; color: var(--muted); }
.calendar-root .field-hint a { color: var(--text-dim); text-decoration: none; }
.calendar-root .field-hint a:hover { text-decoration: underline; color: var(--text); }
.calendar-root .chips-scroll { max-height: 160px; overflow: auto; border: 1px solid var(--border); border-radius: 12px; padding: 0.5rem; background: var(--card); }
.calendar-root .ticket-card { border: 1px solid var(--border); border-radius: 12px; background: var(--card-2); padding: 1rem; display: grid; gap: 1rem; }
.calendar-root .modal-footer { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 0.75rem; margin-top: 1.25rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.12); }
.calendar-root .footer-right { display: flex; flex-wrap: wrap; align-items: center; gap: 0.6rem; }
.calendar-root .footer-left .btn { min-width: 100px; }

@media (max-width: 768px) {
  .calendar-root .field-grid.two,
  .calendar-root .field-grid.three { grid-template-columns: minmax(0, 1fr); }
  .calendar-root .modal-card--wide { max-height: 94vh; }
}
@media (min-width: 1536px) {
  .calendar-root .todo-grid { grid-template-columns: repeat(5, minmax(0, 1fr)); }
}

.calendar-root .todo-section * { box-sizing: border-box; min-width: 0; }
.calendar-root .todo-col { background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 10px; padding: 0.5rem; min-height: 140px; overflow: visible; display: flex; flex-direction: column; }
.calendar-root .todo-col-header { display: flex; align-items: center; justify-content: space-between; font-weight: 600; margin-bottom: 0.5rem; color: var(--text); padding-left: 6px; }
.calendar-root .todo-count { font-size: 0.75rem; background: #1e293b; color: #93c5fd; padding: 0.1rem 0.45rem; border-radius: 999px; border: 1px solid var(--border); }

.calendar-root .todo-adder { display: grid; grid-template-columns: 1fr auto; gap: 0.4rem; align-items: center; margin-bottom: 0.4rem; width: 100%; }
.calendar-root .todo-input { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.35rem 0.5rem; background: var(--card-2); color: var(--text); }
.calendar-root .todo-add-btn { white-space: nowrap; }

.calendar-root .todo-list { display: grid; gap: 0.4rem; width: 100%; flex: 1 1 auto; overflow: auto; }
.calendar-root .todo-card { border: 1px solid var(--border); border-radius: 10px; padding: 0.4rem 0.5rem; background: var(--elev-2); color: var(--text); overflow: visible; }
.calendar-root .todo-row { display: grid; grid-template-columns: 1.1rem 1fr; gap: 0.5rem; align-items: flex-start; }
.calendar-root .todo-text { word-break: break-word; white-space: normal; color: var(--text); }
.calendar-root .todo-actions { display: flex; justify-content: flex-end; gap: 0.5rem; align-items: center; margin-top: 0.35rem; }
.calendar-root .todo-move { display: none; }
.calendar-root .todo-del { border: 1px solid var(--border); border-radius: 8px; padding: 0 0.55rem; background: var(--card); color: #ff453a; }

/* Hard force event backgrounds to transparent for chip style */
.calendar-root .fc .fc-event.evt-guardrail,
.calendar-root .fc .fc-h-event.evt-guardrail,
.calendar-root .fc .fc-daygrid-event.evt-guardrail,
.calendar-root .fc .fc-timegrid-event.evt-guardrail,
.calendar-root .fc .fc-event.evt-fence,
.calendar-root .fc .fc-h-event.evt-fence,
.calendar-root .fc .fc-daygrid-event.evt-fence,
.calendar-root .fc .fc-timegrid-event.evt-fence,
.calendar-root .fc .fc-event.evt-attenuator,
.calendar-root .fc .fc-h-event.evt-attenuator,
.calendar-root .fc .fc-daygrid-event.evt-attenuator,
.calendar-root .fc .fc-timegrid-event.evt-attenuator,
.calendar-root .fc .fc-event.evt-temp-fence,
calendar-root .fc .fc-h-event.evt-temp-fence,
.calendar-root .fc .fc-daygrid-event.evt-temp-fence,
.calendar-root .fc .fc-timegrid-event.evt-temp-fence,
.calendar-root .fc .fc-event.evt-handrail,
.calendar-root .fc .fc-h-event.evt-handrail,
.calendar-root .fc .fc-daygrid-event.evt-handrail,
.calendar-root .fc .fc-timegrid-event.evt-handrail {
  background-color: transparent !important;
  border-color: transparent !important;
  --fc-event-bg-color: transparent;
  --fc-event-border-color: transparent;
  color: inherit !important;
}

/* Subtasks (modal) */
.calendar-root .subtasks { margin-top: 0.25rem; }
.calendar-root .subtasks .input-row { display: grid; grid-template-columns: 1fr auto; gap: 0.5rem; align-items: center; }
.calendar-root .subtasks .subtask-input { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.5rem 0.6rem; background: var(--card-2); color: var(--text); }
.calendar-root .subtasks .subtask-list { display: grid; gap: 0.5rem; margin-top: 0.5rem; }
.calendar-root .subtasks .subtask-item { display: grid; grid-template-columns: 1.1rem 1fr auto; align-items: center; gap: 0.5rem; }
.calendar-root .subtasks .subtask-text { color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.calendar-root .subtasks .subtask-text.muted { color: var(--muted); text-decoration: line-through; }
.calendar-root .subtasks .subtask-remove { border: 1px solid var(--border); border-radius: 8px; padding: 0.2rem 0.55rem; background: var(--card); color: #ff453a; }
