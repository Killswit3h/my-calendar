/* ===== Theme tokens (dark, macOS-aligned) ===== */
:root {
  --bg: #1c1c1e;
  --card: #2c2c2e;
  --card-2: #242426;
  --elev-1: #232325;
  --elev-2: #2a2a2c;

  --text: #f2f2f7;
  --text-dim: #aeaeb2;
  --muted: #8e8e93;
  --border: #3a3a3c;

  /* Forest green accent */
  --primary: #1B5E20;
  --ring: 0 0 0 3px rgba(27, 94, 32, .30);
  --primary-contrast: #ffffff;
  --danger: #ff453a;
  --ok: #30d158;

  /* === Job type colors (original mapping) === */
  --evt-guardrail:  #16a34a; /* green */
  --evt-fence:      #f97316; /* orange */
  --evt-attenuator: #ef4444; /* red */
  --evt-temp-fence: #eab308; /* yellow */
  --evt-handrail:   #3b82f6; /* blue */
}

/* Container shell */
.cal-shell { max-width: 1200px; margin-inline: auto; padding-inline: 0.5rem; }
.surface { background: var(--surface); color: var(--text); border: 1px solid var(--border); border-radius: 12px; backdrop-filter: blur(var(--glass-blur-12)); -webkit-backdrop-filter: blur(var(--glass-blur-12)); box-shadow: 0 2px 8px rgba(0,0,0,.3); }
.muted-sm { color: var(--muted); font-size: 0.875rem; }
.country-input { width: 4.5rem; padding: 0.25rem 0.5rem; border-radius: 0.375rem; border: 1px solid var(--border); background: var(--elev-1); color: var(--text); }

/* ===== FullCalendar ===== */
.fc { font-size: clamp(12px, 1.1vw, 14px); color: var(--text); }
.fc .fc-toolbar { display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center; }
.fc .fc-toolbar-title { font-size: clamp(16px, 1.6vw, 20px); color: var(--text); font-weight: 700; }
.fc .fc-button { padding: 0.3rem 0.55rem; line-height: 1; background: var(--elev-2); border: 1px solid var(--border); color: var(--text); }
.fc .fc-button-primary { background: var(--primary) !important; border-color: var(--primary) !important; color: var(--primary-contrast) !important; }
.fc .fc-button-group .fc-button { border-radius: 0; }
.fc .fc-button-group .fc-button:first-child { border-top-left-radius: 10px; border-bottom-left-radius: 10px; }
.fc .fc-button-group .fc-button:last-child { border-top-right-radius: 10px; border-bottom-right-radius: 10px; }
.fc .fc-button-group .fc-button + .fc-button { margin-left: -1px; }
.fc .fc-button:hover { filter: brightness(1.1); }
.fc .fc-button-primary:not(:disabled).fc-button-active,
.fc .fc-button-primary:not(:disabled):active { background: var(--primary); border-color: var(--primary); color: var(--primary-contrast); }
.fc-theme-standard .fc-scrollgrid, .fc-theme-standard td, .fc-theme-standard th { border-color: var(--border); }
.fc .fc-daygrid-day-top { display: flex; align-items: center; justify-content: space-between; gap: 4px; padding: 2px 4px; }
.fc .fc-daygrid-day-number { color: var(--text-dim); font-size: clamp(11px, 1vw, 13px); position: relative; z-index: 1; }
.fc .fc-daygrid-day.fc-day-other .fc-daygrid-day-number { opacity: .55; }
.fc .fc-daygrid-day.fc-day-today { background: transparent; }
.fc .fc-daygrid-day.fc-day-today .fc-daygrid-day-number { color: var(--text); background: transparent; border-radius: 999px; padding: 2px 8px; box-shadow: 0 0 0 2px var(--accent-500) inset; }
.fc-daygrid-day-frame, .fc-daygrid-day-events { min-height: 3.25rem; }
/* Reserve room at bottom so events never sit under the + button */
.fc-daygrid-day-events { padding-bottom: 26px; }
.fc-more-link { font-size: 0.75rem; color: var(--text); }
.holiday-bg { background: color-mix(in srgb, var(--primary) 12%, transparent); }

/* Ensure day frame can position absolute children (for + button) */
.fc-daygrid-day-frame { position: relative; }
.day-add-btn {
  position: absolute;
  right: 4px;
  bottom: 4px;
  width: 22px;
  height: 22px;
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--card);
  color: var(--text);
  font-size: 14px;
  opacity: 0.9;
  z-index: 3; /* keep above day events */
  box-shadow: 0 1px 3px rgba(0,0,0,.35);
}
.day-add-btn:hover { filter: brightness(1.1); }
.day-add-btn:focus { outline: none; box-shadow: var(--ring); }

/* Drag-and-drop highlights */
.drop-target-day { outline: 2px dashed var(--primary); outline-offset: -2px; }
.drop-target-event { box-shadow: 0 0 0 3px rgba(27, 94, 32, .35) inset; }

/* === Force event colors (works in all views) === */
.fc .fc-event.evt-guardrail {
  --fc-event-bg-color: var(--evt-guardrail);
  --fc-event-border-color: var(--evt-guardrail);
  --fc-event-text-color: #fff;
}
.fc .fc-event.evt-fence {
  --fc-event-bg-color: var(--evt-fence);
  --fc-event-border-color: var(--evt-fence);
  --fc-event-text-color: #fff;
}
.fc .fc-event.evt-attenuator {
  --fc-event-bg-color: var(--evt-attenuator);
  --fc-event-border-color: var(--evt-attenuator);
  --fc-event-text-color: #fff;
}
.fc .fc-event.evt-temp-fence {
  --fc-event-bg-color: var(--evt-temp-fence);
  --fc-event-border-color: var(--evt-temp-fence);
  --fc-event-text-color: #fff; /* white text on yellow */
}
.fc .fc-event.evt-handrail {
  --fc-event-bg-color: var(--evt-handrail);
  --fc-event-border-color: var(--evt-handrail);
  --fc-event-text-color: #fff;
}
.fc .fc-event.evt-guardrail .fc-event-main,
.fc .fc-event.evt-fence .fc-event-main,
.fc .fc-event.evt-attenuator .fc-event-main,
.fc .fc-event.evt-temp-fence .fc-event-main,
.fc .fc-event.evt-handrail .fc-event-main { color: inherit; }

.qty-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.1rem 0.45rem;
  border-radius: 999px;
  font-size: 0.65rem;
  font-weight: 600;
  letter-spacing: 0.04em;
  background: rgba(255, 255, 255, 0.22);
  color: #fff;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.35);
}

/* ===== Modal: Add event ===== */
.modal-root { position: fixed; inset: 0; background: color-mix(in srgb, #000 45%, transparent); display: grid; place-items: center; padding: 1rem; backdrop-filter: blur(var(--glass-blur-16)); }
.modal-card { width: min(720px, 96vw); max-height: 90vh; overflow: auto; background: var(--elevated); color: var(--text); border: 1px solid var(--border); border-radius: 16px; box-shadow: 0 24px 60px rgba(0,0,0,.45); padding: 1rem 1.25rem; backdrop-filter: blur(var(--glass-blur-16)); -webkit-backdrop-filter: blur(var(--glass-blur-16)); }
.modal-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--text); }
.form-grid { display: grid; grid-template-columns: 1fr; gap: 0.75rem; align-items: start; }
.form-grid * { box-sizing: border-box; min-width: 0; }
.form-grid label { display: grid; gap: 0.5rem; }
.form-grid .label { 
  font-size: 0.875rem; 
  color: #FFFFFF; 
  font-weight: 500; 
  font-family: Inter, system-ui, sans-serif;
}
.form-grid input, .form-grid select, .form-grid textarea { 
  width: 100%; 
  border: 1px solid #4B5563; 
  border-radius: 0.5rem; 
  padding: 0.75rem 1rem; 
  background: #000000; 
  color: #FFFFFF; 
  font-size: 0.875rem;
  font-weight: 500;
  font-family: Inter, system-ui, sans-serif;
  transition: all 0.2s ease;
}
.form-grid input::placeholder, .form-grid textarea::placeholder {
  color: #FFFFFF;
  font-weight: 400;
  opacity: 0.7;
}
.form-grid input:focus, .form-grid select:focus, .form-grid textarea:focus {
  outline: none;
  border-color: #22C55E;
  background: #000000;
}
.form-grid input:hover, .form-grid select:hover, .form-grid textarea:hover {
  border-color: #6B7280;
  background: #000000;
}
.form-grid textarea { min-height: 100px; resize: vertical; }
.inline { display: inline-flex; align-items: center; gap: 0.5rem; }

/* Select dropdown styling - White arrow */
.form-grid select {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23E5E5E5' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1rem;
  padding-right: 2.5rem;
}

@media (min-width: 640px) { 
  .form-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } 
  .span-2 { grid-column: 1 / -1; } 
}

/* Helper Text and Additional Elements */
.helper-text {
  color: #9CA3AF;
  font-size: 0.75rem;
  font-weight: 500;
  margin-top: 0.25rem;
}
.muted-text {
  color: #9CA3AF;
  font-size: 0.875rem;
  font-weight: 500;
}
.disabled-text {
  color: #6B7280;
  font-size: 0.875rem;
  font-weight: 400;
}

/* Ensure all text in modal has proper contrast */
.modal-content p, .modal-content span, .modal-content div {
  color: #FFFFFF;
}
.modal-content .text-muted {
  color: #FFFFFF;
  opacity: 0.8;
}
.modal-content .text-disabled {
  color: #FFFFFF;
  opacity: 0.6;
}

/* Force white text for all form elements */
.form-grid * {
  color: #FFFFFF !important;
}
.form-grid input, .form-grid select, .form-grid textarea {
  color: #FFFFFF !important;
}
.form-grid label, .form-grid .label {
  color: #FFFFFF !important;
}

/* Ensure input values are always white */
input[type="text"],
input[type="date"],
input[type="datetime-local"],
input[type="time"],
select,
textarea {
  color: #FFFFFF !important;
}

/* Force white text for all input elements in modal */
.bg-\[#1A1A1A\] input,
.bg-\[#1A1A1A\] select,
.bg-\[#1A1A1A\] textarea {
  color: #FFFFFF !important;
}

/* Ensure all modal elements have white text */
.modal-card,
.modal-card * {
  color: #FFFFFF !important;
}

/* Force white text for all text elements in modals */
.modal-card p,
.modal-card span,
.modal-card div,
.modal-card label,
.modal-card .label {
  color: #FFFFFF !important;
}

/* Ensure checkbox labels are white */
.modal-card label.inline span {
  color: #FFFFFF !important;
}

/* Modal actions buttons styling */
.modal-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
  margin-top: 1rem;
}
.btn {
  height: 40px;
  padding: 0 24px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border-radius: 20px;
  border: none;
  background: var(--primary);
  color: #FFFFFF;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.875rem;
}
.btn:hover { 
  filter: brightness(1.1); 
}
.btn.ghost { 
  background: transparent; 
  color: #22C55E; 
  border: 1px solid transparent;
}
.btn.ghost:hover {
  background: #22C55E;
  background-opacity: 0.1;
}
.btn.primary { 
  background: #22C55E; 
  color: #FFFFFF; 
}
.btn.tiny { 
  height: 28px; 
  padding: 0 12px; 
  font-size: 0.75rem; 
}

/* Toggle Switch Styling - Reference Screenshot Match */
.toggle-switch {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}
.toggle-switch input[type="checkbox"] {
  appearance: none;
  width: 44px;
  height: 24px;
  background: #374151;
  border-radius: 12px;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid #4B5563;
}
.toggle-switch input[type="checkbox"]:checked {
  background: #22C55E;
  border-color: #22C55E;
}
.toggle-switch input[type="checkbox"]:hover {
  border-color: #6B7280;
}
.toggle-switch input[type="checkbox"]:checked:hover {
  border-color: #16A34A;
  background: #16A34A;
}
.toggle-switch input[type="checkbox"]::before {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 18px;
  height: 18px;
  background: #FFFFFF;
  border-radius: 50%;
  transition: transform 0.2s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}
.toggle-switch input[type="checkbox"]:checked::before {
  transform: translateX(20px);
}
.toggle-switch label {
  color: #FFFFFF;
  font-weight: 500;
  font-size: 0.875rem;
  cursor: pointer;
  margin-left: 0.5rem;
}

/* Work Time Toggle - Reference Screenshot Match */
.work-time-toggle {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.work-time-toggle button {
  padding: 0.5rem 1rem;
  border: 1px solid #4B5563;
  background: #000000;
  color: #FFFFFF;
  border-radius: 9999px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.875rem;
  font-weight: 500;
  font-family: Inter, system-ui, sans-serif;
}
.work-time-toggle button.active {
  background: #22C55E;
  color: #FFFFFF;
  border-color: #22C55E;
}
.work-time-toggle button:hover:not(.active) {
  color: #FFFFFF;
  border-color: #6B7280;
  background: #000000;
}
.work-time-toggle button:focus {
  outline: none;
  border-color: #22C55E;
}

/* ===== Modal tabs ===== */
.modal-card--wide { width: min(860px, 96vw); max-height: 92vh; overflow: hidden; display: flex; flex-direction: column; }
.modal-content { display: flex; flex-direction: column; gap: 1.25rem; overflow-y: auto; padding-right: 0.25rem; flex: 1 1 auto; }
.tab-nav { display: flex; gap: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.12); padding-bottom: 0.5rem; flex-wrap: wrap; }
.tab-button { padding: 0.4rem 0.9rem; border-radius: 999px; border: 1px solid transparent; background: transparent; color: var(--text-dim); font-size: 0.9rem; cursor: pointer; transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease; }
.tab-button:hover { color: var(--text); }
.tab-button.active { background: rgba(31, 122, 77, 0.2); color: var(--text); border-color: rgba(34, 160, 107, 0.4); }
.tab-panels { display: block; }
.tab-panel { display: none; }
.tab-panel.active { display: block; }
.tab-stack { display: grid; gap: 1.25rem; }
.field { display: flex; flex-direction: column; gap: 0.35rem; }
.field-grid { display: grid; gap: 1rem; align-items: start; }
.field-grid.two { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
.field-grid.three { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
.field.span-2 { grid-column: 1 / -1; }
.field input,
.field textarea,
.field select { width: 100%; border-radius: 10px; border: 1px solid var(--border); padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); min-height: 44px; }
.field textarea { min-height: 110px; resize: vertical; }
.inline-select { display: flex; align-items: center; gap: 0.5rem; }
.inline-select select { flex: 1; padding: 0.5rem 0.65rem; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); min-height: 44px; }
.footer-left { justify-content: flex-start; }
.footer-left .btn { min-width: 100px; }

@media (max-width: 768px) {
  .field-grid.two,
  .field-grid.three { grid-template-columns: minmax(0, 1fr); }
  .modal-card--wide { max-height: 94vh; }
}
.form-grid label { display: grid; gap: 0.25rem; }
.form-grid .label { font-size: 0.875rem; color: var(--text-dim); }
.form-grid input, .form-grid select, .form-grid textarea { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); }
.form-grid textarea { min-height: 100px; resize: vertical; }
.inline { display: inline-flex; align-items: center; gap: 0.5rem; }
@media (min-width: 640px) { .form-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } .span-2 { grid-column: 1 / -1; } }
.modal-actions { display: flex; gap: 0.5rem; justify-content: flex-end; }
.btn {
  height: 40px;
  padding: 0 24px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border-radius: 20px;
  border: none;
  background: var(--primary);
  color: var(--primary-contrast);
  font-size: 1rem;
  font-family: inherit;
  cursor: pointer;
  transition: box-shadow .2s ease, background .2s ease;
}

.btn:hover { box-shadow: 0 2px 6px rgba(0,0,0,.3); }
.btn:focus-visible { outline: none; box-shadow: var(--ring); }
.btn:active { box-shadow: none; }

.btn.primary {
  background: var(--primary);
  color: var(--primary-contrast);
}

.btn.danger {
  background: var(--danger);
  color: var(--md-sys-color-on-error);
}

.btn.ghost {
  background: transparent;
  color: var(--primary);
}
.form-section { font-size: 0.9rem; font-weight: 500; color: var(--text); margin-top: 0.5rem; }
.label .ico { width: 1rem; height: 1rem; margin-right: 0.25rem; }
.type-chip { width: 12px; height: 12px; border-radius: 999px; display: inline-block; }
.shift-toggle { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); }
.shift-toggle.night { background: var(--elev-2); }
.form-grid input, .form-grid select, .form-grid textarea, .shift-toggle { min-height: 44px; }


/* ===== Day Weather (tiny, next to date) ===== */
.fc .day-weather { margin-left: 2px; margin-right: 0; font-size: 0.72rem; color: var(--text-dim); text-decoration: none; display: inline-flex; gap: 4px; align-items: center; opacity: .95; }
.fc .day-weather:hover { text-decoration: underline; color: var(--text); }
.fc .day-weather .ico { font-size: 0.9em; line-height: 1; }

/* ===== Full-bleed helpers ===== */
.calendar-bleed,
.todo-bleed {
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;
  width: 100vw;
}

/* Full-width control row above calendar */
.cal-controls { display: flex; align-items: center; justify-content: flex-start; min-height: 56px; padding: 0 16px; gap: 10px; flex-wrap: wrap; margin-bottom: 1rem; }
.cal-controls input { border: 1px solid var(--border); border-radius: 10px; padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); min-height: 44px; }
/* Make search and quick-add inputs share the same width */
.search-input { width: min(100%, 600px); max-width: 600px; }
/* Ensure the quick-add form itself adopts the same max width so the input matches the Search box */
#quick-add-form { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; width: min(100%, 600px); max-width: 600px; }
.view-toggle .btn { min-height: 44px; }
.tablet-split { display: flex; gap: 1rem; }
/* Prioritize calendar: 75% calendar, 25% sidebar */
.calendar-pane { flex: 1 1 75%; }
.details-pane { flex: 0 0 488px; width: 488px; height: 471px; overflow: auto; min-width: 240px; }
mark { background: var(--primary); color: var(--primary-contrast); }

/* ===== Options dropdown ===== */
.options-wrap { position: relative; display: inline-block; }
.cal-controls .options-wrap:first-of-type { position: absolute; left: 8px; top: 6px; z-index: 60; }
.menu-card { position: absolute; top: calc(100% + 6px); left: 0; min-width: 220px; background-color: rgba(23,23,23,1); border: 1px solid var(--border); border-radius: 12px; padding: 6px; z-index: 50; box-shadow: 0 8px 20px rgba(0,0,0,.35); backdrop-filter: blur(var(--glass-blur-12)); -webkit-backdrop-filter: blur(var(--glass-blur-12)); color: rgba(23,23,23,1); }
.menu-item, .menu-card .btn, .menu-row, .menu-card a { display: flex; align-items: center; gap: 10px; width: 100%; text-align: left; background: transparent !important; color: var(--text) !important; border: 0 !important; padding: 10px 12px; border-radius: 10px; text-decoration: none; font-size: 0.95rem; line-height: 1.2; }
.menu-item:hover, .menu-card .btn:hover, .menu-row:hover, .menu-card a:hover { background: var(--elev-2) !important; filter: none !important; }
.menu-ico { width: 18px; display: inline-block; text-align: center; opacity: .9; }
.menu-text { flex: 1 1 auto; }

/* Discrete icon button for top-left options */
.icon-btn { min-width: 32px; min-height: 32px; width: 32px; height: 32px; border-radius: 999px; padding: 0; border: 1px solid var(--border); background: var(--elev-2); color: var(--text-dim); line-height: 1; display: inline-flex; align-items: center; justify-content: center; }
.icon-btn:hover { filter: brightness(1.1); color: var(--text); }

/* Hide legacy options block in the second control row */
.cal-controls > div:nth-of-type(2) .options-wrap { display: none; }

/* Add icon for Employees link rendered via EmployeesLink (btn class inside menu) */
.menu-card a[href^="/employees"], .menu-card .btn[href^="/employees"] { display: flex; align-items: center; gap: 10px; }
.menu-card a[href^="/employees"]::before, .menu-card .btn[href^="/employees"]::before { content: 'ðŸ‘¥'; width: 18px; text-align: center; opacity: .9; }
/* ===== Mobile drawer for Unassigned ===== */
@media (max-width: 767px) {
  .details-pane { display: none; }
  .calendar-pane { flex: 1 1 100%; }
}
.fab-people {
  position: fixed;
  right: 12px;
  bottom: 12px;
  width: 44px; height: 44px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--primary);
  color: var(--primary-contrast);
  display: inline-flex; align-items: center; justify-content: center;
  box-shadow: 0 6px 16px rgba(0,0,0,.35);
  z-index: 70;
}
.fab-people:hover { filter: brightness(1.05); }
.fab-people .fab-badge { position: absolute; top: -4px; right: -4px; min-width: 18px; height: 18px; padding: 0 4px; border-radius: 999px; background: #ef4444; color: #fff; font-size: 11px; line-height: 18px; text-align: center; border: 1px solid rgba(0,0,0,.3); }

.drawer-root { position: fixed; inset: 0; background: color-mix(in srgb, #000 45%, transparent); z-index: 80; display: flex; justify-content: flex-end; }
.drawer-panel { width: min(92vw, 360px); height: 100%; background: var(--elevated); border-left: 1px solid var(--border); padding: 12px; overflow: auto; backdrop-filter: blur(var(--glass-blur-12)); -webkit-backdrop-filter: blur(var(--glass-blur-12)); }
.drawer-header { display: flex; align-items: center; justify-content: space-between; font-weight: 600; margin-bottom: 8px; }

/* ===== TODO BOARD ===== */
.todo-section { margin-top: 1rem; }
.todo-title { font-size: 1.125rem; font-weight: 600; margin: 0.25rem 0 0.75rem; color: var(--text); text-align: center; }

/* Equal-width, full-bleed columns */
.todo-grid {
  display: grid;
  gap: 0.5rem;
  /* Auto-fit columns that responsively fill the page */
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  align-items: start; /* prevent equal-height stretching across columns */
}

/* ===== Quantities editor ===== */
.qty-editor { margin-top: 1.25rem; padding: 1rem; border-radius: 12px; background: var(--card-2); border: 1px solid var(--border); }
.qty-header { display: flex; align-items: center; justify-content: space-between; gap: 1rem; margin-bottom: 0.75rem; flex-wrap: wrap; }
.qty-header h4 { margin: 0; font-size: 1rem; font-weight: 600; }
.qty-actions { display: inline-flex; gap: 0.5rem; flex-wrap: wrap; }
.qty-grid { display: grid; gap: 0.75rem; }
.qty-row { display: grid; gap: 0.75rem; grid-template-columns: minmax(0, 1fr); align-items: start; padding: 0.9rem; border: 1px solid var(--border); border-radius: 12px; background: var(--elev-1); }
.qty-cell label, .qty-fields label { display: grid; gap: 0.35rem; }
.qty-cell input, .qty-cell textarea, .qty-fields input, .qty-fields textarea { width: 100%; padding: 0.55rem 0.7rem; border: 1px solid var(--border); border-radius: 10px; background: var(--card); color: var(--text); font-size: 0.95rem; }
.qty-fields { display: grid; gap: 0.75rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
.qty-fields textarea { min-height: 88px; resize: vertical; }
.qty-cell.qty-unit input { background: rgba(255,255,255,0.05); color: var(--text); opacity: 0.85; }
.qty-actions-column { display: flex; justify-content: flex-end; align-items: center; gap: 0.5rem; }
.qty-fields input { font-variant-numeric: tabular-nums; }
.qty-hint { margin-top: 0.75rem; color: var(--muted); font-size: 0.85rem; }
.qty-loading { color: var(--text-dim); font-size: 0.9rem; }
.qty-error { margin-bottom: 0.75rem; padding: 0.75rem 1rem; border-radius: 10px; background: rgba(255, 69, 58, 0.15); color: #ffd7d0; border: 1px solid rgba(255, 69, 58, 0.35); }
.qty-payitem-search { position: relative; display: grid; gap: 0.5rem; }
.qty-payitem-search input { padding-right: 3rem; }
.qty-payitem-search .btn { height: 36px; justify-content: center; }
.qty-payitem-search .btn.ghost { border: 1px solid var(--border); padding: 0 12px; border-radius: 999px; background: transparent; color: var(--text); }
.qty-payitem-search .btn.ghost:hover { background: rgba(255,255,255,0.05); }
.qty-suggestions { position: absolute; z-index: 90; top: calc(100% + 4px); left: 0; right: 0; background: var(--elev-2); border: 1px solid var(--border); border-radius: 10px; max-height: 220px; overflow: auto; padding: 4px; display: grid; gap: 4px; box-shadow: 0 16px 32px rgba(0,0,0,0.35); }
.qty-suggestions li { list-style: none; }
.qty-suggestions button { width: 100%; border: none; display: grid; grid-template-columns: minmax(0, 120px) 1fr auto; gap: 0.5rem; align-items: center; border-radius: 8px; padding: 0.5rem 0.6rem; background: transparent; color: var(--text); text-align: left; cursor: pointer; }
.qty-suggestions button:hover, .qty-suggestions button:focus-visible { background: rgba(255,255,255,0.08); outline: none; }
.qty-suggestion-number { font-weight: 600; font-size: 0.9rem; }
.qty-suggestion-desc { font-size: 0.85rem; }
.qty-suggestion-unit { font-size: 0.75rem; text-align: right; color: var(--muted); }

@media (max-width: 900px) {
  .qty-fields { grid-template-columns: minmax(0, 1fr); }
}

/* ===== Pay item manager ===== */
.payitems-card { border: 1px solid var(--border); border-radius: 12px; padding: 1rem; margin-bottom: 1rem; background: var(--card-2); }
.payitems-input { width: 100%; padding: 0.5rem 0.6rem; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--text); }
.payitems-textarea { width: 100%; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); padding: 0.75rem; font-family: ui-monospace, SFMono-Regular, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
.payitems-create-grid { display: grid; gap: 0.75rem; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); align-items: end; }
.payitems-actions { display: flex; justify-content: flex-end; }
.payitems-table-wrapper { overflow-x: auto; border-radius: 10px; border: 1px solid var(--border); background: var(--elev-1); }
.payitems-table { width: 100%; border-collapse: collapse; }
.payitems-table th, .payitems-table td { text-align: left; padding: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.08); }
.payitems-table-actions { text-align: right; }
.payitems-import-actions { display: flex; gap: 0.75rem; margin-top: 0.75rem; }
.payitems-errors { margin: 0.5rem 0; color: #ffb4a9; font-size: 0.85rem; list-style: square; padding-left: 1.5rem; }
.payitems-card .btn { height: 36px; min-height: 36px; }
.payitems-condensed .payitems-card { padding: 0.75rem; }
.payitems-condensed .payitems-import-actions { flex-wrap: wrap; }

/* ===== Modal tabs ===== */
.modal-card--wide { width: min(860px, 96vw); max-height: 92vh; overflow: hidden; display: flex; flex-direction: column; }
.modal-content { display: flex; flex-direction: column; gap: 1.25rem; overflow-y: auto; padding-right: 0.25rem; flex: 1 1 auto; }
.tab-nav { display: flex; gap: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.12); padding-bottom: 0.5rem; flex-wrap: wrap; }
.tab-button { padding: 0.4rem 0.9rem; border-radius: 999px; border: 1px solid transparent; background: transparent; color: var(--text-dim); font-size: 0.9rem; cursor: pointer; transition: background 0.2s ease, color 0.2s ease, border-color 0.2s ease; }
.tab-button:hover { color: var(--text); }
.tab-button.active { background: rgba(31, 122, 77, 0.2); color: var(--text); border-color: rgba(34, 160, 107, 0.4); }
.tab-panels { display: block; }
.tab-panel { display: none; }
.tab-panel.active { display: block; }
.tab-stack { display: grid; gap: 1.25rem; }
.field { display: flex; flex-direction: column; gap: 0.35rem; }
.field-grid { display: grid; gap: 1rem; align-items: start; }
.field-grid.two { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
.field-grid.three { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
.field.span-2 { grid-column: 1 / -1; }
.field input,
.field textarea,
.field select { width: 100%; border-radius: 10px; border: 1px solid var(--border); padding: 0.55rem 0.65rem; background: var(--card-2); color: var(--text); min-height: 44px; }
.field textarea { min-height: 110px; resize: vertical; }
.inline-select { display: flex; align-items: center; gap: 0.5rem; }
.inline-select select { flex: 1; padding: 0.5rem 0.65rem; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); min-height: 44px; }
.toggle-button { width: 100%; min-height: 44px; border-radius: 10px; border: 1px solid var(--border); background: var(--card-2); color: var(--text); padding: 0.55rem 0.75rem; cursor: pointer; transition: background 0.2s ease, border-color 0.2s ease; }
.toggle-button:hover { border-color: rgba(34, 160, 107, 0.6); }
.toggle-button.active { background: var(--primary); border-color: var(--primary); color: var(--primary-contrast); }
.field .label { font-size: 0.85rem; color: var(--text-dim); font-weight: 500; }
.field input,
.field select,
.field textarea { width: 100%; border: 1px solid var(--border); border-radius: 10px; background: var(--card-2); color: var(--text); padding: 0.55rem 0.65rem; min-height: 44px; }
.field textarea { min-height: 120px; resize: vertical; }
.field-hint { font-size: 0.8rem; color: var(--muted); }
.field-hint a { color: var(--text-dim); text-decoration: none; }
.field-hint a:hover { text-decoration: underline; color: var(--text); }
.chips-scroll { max-height: 160px; overflow: auto; border: 1px solid var(--border); border-radius: 12px; padding: 0.5rem; background: var(--card); }
.ticket-card { border: 1px solid var(--border); border-radius: 12px; background: var(--card-2); padding: 1rem; display: grid; gap: 1rem; }
.modal-footer { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 0.75rem; margin-top: 1.25rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.12); }
.footer-right { display: flex; flex-wrap: wrap; align-items: center; gap: 0.6rem; }
.footer-left .btn { min-width: 100px; }

@media (max-width: 768px) {
  .field-grid.two,
  .field-grid.three { grid-template-columns: minmax(0, 1fr); }
  .modal-card--wide { max-height: 94vh; }
}
@media (min-width: 1536px) { .todo-grid { grid-template-columns: repeat(5, minmax(0, 1fr)); } }

.todo-section * { box-sizing: border-box; min-width: 0; }
.todo-col { background: var(--card); color: var(--text); border: 1px solid var(--border); border-radius: 10px; padding: 0.5rem; min-height: 140px; overflow: visible; display: flex; flex-direction: column; }
.todo-col-header { display: flex; align-items: center; justify-content: space-between; font-weight: 600; margin-bottom: 0.5rem; color: var(--text); padding-left: 6px; }
.todo-count { font-size: 0.75rem; background: #1e293b; color: #93c5fd; padding: 0.1rem 0.45rem; border-radius: 999px; border: 1px solid var(--border); }

.todo-adder { display: grid; grid-template-columns: 1fr auto; gap: 0.4rem; align-items: center; margin-bottom: 0.4rem; width: 100%; }
.todo-input { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.35rem 0.5rem; background: var(--card-2); color: var(--text); }
.todo-add-btn { white-space: nowrap; }

.todo-list { display: grid; gap: 0.4rem; width: 100%; flex: 1 1 auto; overflow: auto; }
.todo-card { border: 1px solid var(--border); border-radius: 10px; padding: 0.4rem 0.5rem; background: var(--elev-2); color: var(--text); overflow: visible; }
.todo-row { display: grid; grid-template-columns: 1.1rem 1fr; gap: 0.5rem; align-items: flex-start; }
.todo-text { word-break: break-word; white-space: normal; color: var(--text); }
.todo-actions { display: flex; justify-content: flex-end; gap: 0.5rem; align-items: center; margin-top: 0.35rem; }
.todo-move { display: none; }
.todo-del { border: 1px solid var(--border); border-radius: 8px; padding: 0 0.55rem; background: var(--card); color: var(--danger); }

/* === Hard force event background colors === */
.fc .fc-event.evt-guardrail,
.fc .fc-h-event.evt-guardrail,
.fc .fc-daygrid-event.evt-guardrail,
.fc .fc-timegrid-event.evt-guardrail {
  background-color: var(--evt-guardrail) !important;
  border-color: var(--evt-guardrail) !important;
  --fc-event-bg-color: var(--evt-guardrail);
  --fc-event-border-color: var(--evt-guardrail);
  color: #fff !important;
}
.fc .fc-event.evt-fence,
.fc .fc-h-event.evt-fence,
.fc .fc-daygrid-event.evt-fence,
.fc .fc-timegrid-event.evt-fence {
  background-color: var(--evt-fence) !important;
  border-color: var(--evt-fence) !important;
  --fc-event-bg-color: var(--evt-fence);
  --fc-event-border-color: var(--evt-fence);
  color: #fff !important;
}
.fc .fc-event.evt-attenuator,
.fc .fc-h-event.evt-attenuator,
.fc .fc-daygrid-event.evt-attenuator,
.fc .fc-timegrid-event.evt-attenuator {
  background-color: var(--evt-attenuator) !important;
  border-color: var(--evt-attenuator) !important;
  --fc-event-bg-color: var(--evt-attenuator);
  --fc-event-border-color: var(--evt-attenuator);
  color: #fff !important;
}
.fc .fc-event.evt-temp-fence,
.fc .fc-h-event.evt-temp-fence,
.fc .fc-daygrid-event.evt-temp-fence,
.fc .fc-timegrid-event.evt-temp-fence {
  background-color: var(--evt-temp-fence) !important;
  border-color: var(--evt-temp-fence) !important;
  --fc-event-bg-color: var(--evt-temp-fence);
  --fc-event-border-color: var(--evt-temp-fence);
  color: #fff !important; /* white text on yellow */
}
.fc .fc-event.evt-handrail,
.fc .fc-h-event.evt-handrail,
.fc .fc-daygrid-event.evt-handrail,
.fc .fc-timegrid-event.evt-handrail {
  background-color: var(--evt-handrail) !important;
  border-color: var(--evt-handrail) !important;
  --fc-event-bg-color: var(--evt-handrail);
  --fc-event-border-color: var(--evt-handrail);
  color: #fff !important;
}

/* Ensure inner text uses the forced color */
.fc .fc-event.evt-guardrail .fc-event-main,
.fc .fc-event.evt-fence .fc-event-main,
.fc .fc-event.evt-attenuator .fc-event-main,
.fc .fc-event.evt-temp-fence .fc-event-main,
.fc .fc-event.evt-handrail .fc-event-main { color: inherit !important; }

/* Compact Google Maps link inside events */
.fc .event-gmap-link {
  margin-left: 0.35rem;
  font-size: 0.85em;
  color: currentColor;
  opacity: 0.85;
  text-decoration: none;
  flex: 0 0 auto;
}
.fc .event-gmap-link:hover { text-decoration: underline; opacity: 1; }
/* Ensure long event titles truncate with ellipsis inside chips */
.fc .fc-event .fc-event-main { overflow: hidden; }
.fc .fc-event .evt-title {
  display: inline-block;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1 1 auto;
  min-width: 0;
}

/* ===== Subtasks (modal) ===== */
.subtasks { margin-top: 0.25rem; }
.subtasks .input-row { display: grid; grid-template-columns: 1fr auto; gap: 0.5rem; align-items: center; }
.subtasks .input-row .subtask-input { width: 100%; border: 1px solid var(--border); border-radius: 10px; padding: 0.5rem 0.6rem; background: var(--card-2); color: var(--text); }
.subtasks .subtask-list { display: grid; gap: 0.5rem; margin-top: 0.5rem; }
.subtasks .subtask-item { display: grid; grid-template-columns: 1.1rem 1fr auto; align-items: center; gap: 0.5rem; }
.subtasks .subtask-text { color: var(--text); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.subtasks .subtask-text.muted { color: var(--muted); text-decoration: line-through; }
.subtasks .subtask-remove { border: 1px solid var(--border); border-radius: 8px; padding: 0.2rem 0.55rem; background: var(--card); color: var(--danger); }
